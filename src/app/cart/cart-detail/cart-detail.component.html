<div *ngIf="showLoader" class="wrapper-loader mb-5">
  <div class="loader"></div>
</div>
<section class="container">
  <div class="row">
    <div class="col-md-12">
      <h3 style="padding: .5rem; background: #ffa217; font-size: larger; color: white;">Récapitulatif du panier</h3>
    </div>
  </div>
  <hr>
  <div *ngIf="cartCurrent" class="row">
    <div *ngIf="cartCurrent.products"  class="col-md-8">
      <div *ngFor="let product of cartCurrent.products">
        <div style="display: flex; flex-direction: column" class="wrapper-card-product">
          <div style="display: flex; flex-direction: row; ">
            <div style="flex: auto;text-align: center;align-self: center; display: flex; justify-content: space-evenly">
              <div>
                <button (click)="onUpdateCart('less', product)" [disabled]="product.quantity == 1" style="min-width: 20px !important; line-height: 1px !important;padding: 0px 2px !important;" mat-raised-button color="primary">
                  <i style="position: relative; margin-top: 0 !important; margin-left: 0 !important; color: white; font-size: 1.3rem;" class="material-icons">remove</i>
                </button>
              </div>
              <div>
                <span style="font-size: x-large;">{{ product.quantity }}</span>
              </div>
              <div>
                <button (click)="onUpdateCart('more', product)" style="min-width: 20px !important; line-height: 1px !important;padding: 0px 2px !important;" mat-raised-button color="primary">
                  <i style="position: relative; margin-top: 0 !important; margin-left: 0 !important; color: white; font-size: 1.3rem;"  class="material-icons">add</i>
                </button>
              </div>
            </div>
            <div style="display: flex;flex-direction: column;flex: 4;margin-top: 7px;font-size: 1rem;font-weight: 600;">
              {{ product.name }}
              <div class="product-ingredient">
                {{ product.description }}
              </div>
            </div>
            <div style="display: flex">
              <div style="align-self: center; font-size: medium;">{{ (+(product.amount)/ 100).toFixed(2) }} €</div>
              <div (click)="onDeleteProduct(product)" style="cursor: pointer" >
                <i style=" position:relative; margin-left: 0;margin-top: 5px;color: #e61818;font-weight: 900;font-size: 1.5rem;padding-left: .5rem;" class="material-icons">
                close
              </i></div>
            </div>
          </div>
          <div>
            <hr>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div style="width: 100%" class="checkout-stripe-form">
        <div style="width: 100%;display: flex; justify-content: space-between; padding: .5rem">
          <div>
            <h5>Stripe</h5>
          </div>
          <div style="">
            <img style="" src="../../../assets/cards_logo.png" width="150" height="auto" alt="logo stripe">
          </div>
        </div>
        <div class="form-row">
          <label for="card-element">
            Credit or debit card
          </label>
          <div id="card-element">
            <!-- A Stripe Element will be inserted here. -->
          </div>

          <!-- Used to display form errors. -->
          <div id="card-errors" role="alert"></div>
        </div>
        <!--<div id="card-element" style="width: 100%">
          <div style="display:flex;">
            <div style="flex: 2; padding-right: 7px" class="form-group">
              <label for="cardNumber">Numéro de carte</label>
              <div id="cardNumber" class="field empty">
              </div>
            </div>

            <div style="flex: auto; padding-right: 7px" class="">
              <label style="display: block !important;" for="cardExpiry">Date d'expiration</label>
              <div id="cardExpiry"  class="field empty">
              </div>
            </div>

            <div style="flex: auto" class="">
              <label style="display: block;" for="cardCvc">CVV</label>
              <div id="cardCvc" class="field empty">
              </div>
              <p style="display: inline-block; font-size: smaller; font-style: italic"></p>
            </div>
          </div>
        </div>-->
      </div>
    </div>
  </div>
  <hr>
  <div class="row">
    <div class="col-md-12">
      <h4>Adresse de livraison</h4>
      <div *ngIf="addressChose">
        Rue: <b>{{ addressChose.street }}</b>
        <div>
          Ville: <b>{{ addressChose.city }}</b>
        </div>
        <div>
          Code postale: <b>{{ addressChose.zipcode }}</b>
        </div>
      </div>
    </div>
  </div>
  <hr>
  <div *ngIf="hasAddressSelected" class="row">
    <div class="col-md-6">
    </div>
    <div style="display: flex" class="col-md-6">
      <div style="flex: 1">Frais de livraison</div>
      <div *ngIf="cartCurrent.deliveryCost"
      >{{ cartCurrent.deliveryCost }} €</div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
    </div>
    <hr>
    <div style="display: flex" class="col-md-6">
      <div style="flex: 1">Frais de service</div>
      <div>0.80 €</div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
    </div>
    <hr>
    <div style="display: flex" class="col-md-6">
      <div style="flex: 1">TOTAL</div>
      <div>{{ (cartCurrent.total.toFixed(2)).replace('.', ',') }} €</div>
    </div>
  </div>
  <hr>
  <div class="row">
  </div>
  <div class="row">
      <div style="display: flex; justify-content: center" class="col-md-12">

      </div>
    <div style="display: flex;margin-top: -.5rem;" class="col-md-12">

    </div>
  </div>


  <div class="row mb-5">
    <div class="col-md-6">
    </div>
      <div style="display: flex;text-align: right;justify-content: flex-end;margin-top: 2rem;" class="col-md-6">
      <button mat-raised-button color="primary" (click)="onProceedCheckout($event)" style="align-self: flex-end">VALIDER LE PAIEMENT</button>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <!--<form id="payment-form">
        <div id="card-element">
        </div>

        <div id="card-errors" role="alert"></div>

        <button id="submit">Livrez-moi!</button>
      </form>-->
    </div>
  </div>
</section>
